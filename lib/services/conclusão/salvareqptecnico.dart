import 'package:http/http.dart' as http;
import 'package:shared_preferences/shared_preferences.dart';

class salvareqtec{
  enviar() async {
    SharedPreferences opcs = await SharedPreferences.getInstance();

    var empresaid = opcs.getInt('sessionid');
    var token = opcs.getString("${empresaid}@token");
    final headers = {
      'Accept': 'application/json',
      'Content-Type': 'application/json',
      'Authorization': 'Bearer $token',
    };

    final data = '{\n    "id": 108527,\n    "veiculo": {\n        "id": 165373,\n        "cliente": {\n            "id": 52754,\n            "empresa": {\n                "id": 195,\n                "nome": " REKTA SOLUÇÕES (DEMO)",\n                "email": "endy@winksysmail.com.br",\n                "telefones": [\n                    {\n                        "id": 17380,\n                        "tipo": 2,\n                        "ddi": "",\n                        "ddd": "47",\n                        "numero": "3237-1988",\n                        "obs": "winksysmaster",\n                        "telefoneCompleto": "Comercial 47 3237-1988"\n                    }\n                ],\n                "endereco": {\n                    "id": 231,\n                    "rua": "Rua Promotor Ribeiro de Carvalho",\n                    "numero": "204",\n                    "bairro": "Vila Nova",\n                    "complemento": "",\n                    "cidade": {\n                        "id": 116137,\n                        "nome": "Blumenau",\n                        "estado": {\n                            "id": 22,\n                            "sigla": "SC",\n                            "nome": "Santa Catarina"\n                        }\n                    },\n                    "cep": "89035-340",\n                    "coordenadas": "-26.9054733,-49.0897666"\n                },\n                "stringTelefone": "(47) 3237-1988",\n                "cnpj": "34.717.377/0001-88"\n            },\n            "pessoa": {\n                "id": 55412,\n                "empresa": {\n                    "id": 195,\n                    "nome": " REKTA SOLUÇÕES (DEMO)",\n                    "email": "endy@winksysmail.com.br",\n                    "telefones": [\n                        {\n                            "id": 17380,\n                            "tipo": 2,\n                            "ddi": "",\n                            "ddd": "47",\n                            "numero": "3237-1988",\n                            "obs": "winksysmaster",\n                            "telefoneCompleto": "Comercial 47 3237-1988"\n                        }\n                    ],\n                    "endereco": {\n                        "id": 231,\n                        "rua": "Rua Promotor Ribeiro de Carvalho",\n                        "numero": "204",\n                        "bairro": "Vila Nova",\n                        "complemento": "",\n                        "cidade": {\n                            "id": 116137,\n                            "nome": "Blumenau",\n                            "estado": {\n                                "id": 22,\n                                "sigla": "SC",\n                                "nome": "Santa Catarina"\n                            }\n                        },\n                        "cep": "89035-340",\n                        "coordenadas": "-26.9054733,-49.0897666"\n                    },\n                    "stringTelefone": "(47) 3237-1988",\n                    "cnpj": "34.717.377/0001-88"\n                },\n                "nome": "Guilherme",\n                "email": "guilherme@winksysmail.com",\n                "telefones": [\n                    {\n                        "id": 67697,\n                        "tipo": 1,\n                        "ddi": "",\n                        "ddd": "47",\n                        "numero": "3334-3539",\n                        "obs": "Sr. Guilherme",\n                        "telefoneCompleto": "Residencial 47 3334-3539"\n                    }\n                ],\n                "endereco": {\n                    "id": 154951,\n                    "rua": "Rua Noel Rosa",\n                    "numero": "20",\n                    "bairro": "Tribess",\n                    "complemento": "Casa",\n                    "cidade": {\n                        "id": 116137,\n                        "nome": "Blumenau",\n                        "estado": {\n                            "id": 22,\n                            "sigla": "SC",\n                            "nome": "Santa Catarina"\n                        }\n                    },\n                    "cep": "89057-420",\n                    "coordenadas": "-26.8764427,-49.0531382"\n                },\n                "stringTelefone": "(47) 3334-3539"\n            }\n        },\n        "empresa": {\n            "id": 195,\n            "nome": " REKTA SOLUÇÕES (DEMO)",\n            "email": "endy@winksysmail.com.br",\n            "telefones": [\n                {\n                    "id": 17380,\n                    "tipo": 2,\n                    "ddi": "",\n                    "ddd": "47",\n                    "numero": "3237-1988",\n                    "obs": "winksysmaster",\n                    "telefoneCompleto": "Comercial 47 3237-1988"\n                }\n            ],\n            "endereco": {\n                "id": 231,\n                "rua": "Rua Promotor Ribeiro de Carvalho",\n                "numero": "204",\n                "bairro": "Vila Nova",\n                "complemento": "",\n                "cidade": {\n                    "id": 116137,\n                    "nome": "Blumenau",\n                    "estado": {\n                        "id": 22,\n                        "sigla": "SC",\n                        "nome": "Santa Catarina"\n                    }\n                },\n                "cep": "89035-340",\n                "coordenadas": "-26.9054733,-49.0897666"\n            },\n            "stringTelefone": "(47) 3237-1988",\n            "cnpj": "34.717.377/0001-88",\n            "fotosNecessarias": "Tirar foto hodometro\\nTirar foto da instalação\\nTirar do equipamento"\n        },\n        "equipamentos": [\n            {\n                "id": 31568,\n                "codigo": "abc teste",\n                "documento": "",\n                "status": "INSTALADO",\n                "cancelado": false,\n                "acessorios": []\n            },\n            {\n                "id": 221554,\n                "codigo": "55555555",\n                "documento": "4534534",\n                "status": "INSTALADO",\n                "cancelado": false,\n                "acessorios": []\n            }\n        ],\n        "placa": "MEL1234",\n        "modelo": "Corsa",\n        "chassi": "DFWSR4324EG6YD7UC",\n        "cor": "Prata",\n        "ano": "2010",\n        "renavan": "h7uj98d5rsf3",\n        "observacao": "",\n        "plataforma": {\n            "nome": "RODAR",\n            "usuario": "a",\n            "tipo": "RODAR",\n            "empresa": {\n                "id": 195,\n                "nome": " REKTA SOLUÇÕES (DEMO)",\n                "email": "endy@winksysmail.com.br",\n                "telefones": [\n                    {\n                        "id": 17380,\n                        "tipo": 2,\n                        "ddi": "",\n                        "ddd": "47",\n                        "numero": "3237-1988",\n                        "obs": "winksysmaster",\n                        "telefoneCompleto": "Comercial 47 3237-1988"\n                    }\n                ],\n                "endereco": {\n                    "id": 231,\n                    "rua": "Rua Promotor Ribeiro de Carvalho",\n                    "numero": "204",\n                    "bairro": "Vila Nova",\n                    "complemento": "",\n                    "cidade": {\n                        "id": 116137,\n                        "nome": "Blumenau",\n                        "estado": {\n                            "id": 22,\n                            "sigla": "SC",\n                            "nome": "Santa Catarina"\n                        }\n                    },\n                    "cep": "89035-340",\n                    "coordenadas": "-26.9054733,-49.0897666"\n                },\n                "stringTelefone": "(47) 3237-1988",\n                "cnpj": "34.717.377/0001-88"\n            }\n        }\n    },\n    "tecnico": {\n        "id": 624,\n        "pessoa": {\n            "id": 15918,\n            "empresa": {\n                "id": 195,\n                "nome": " REKTA SOLUÇÕES (DEMO)",\n                "email": "endy@winksysmail.com.br",\n                "telefones": [\n                    {\n                        "id": 17380,\n                        "tipo": 2,\n                        "ddi": "",\n                        "ddd": "47",\n                        "numero": "3237-1988",\n                        "obs": "winksysmaster",\n                        "telefoneCompleto": "Comercial 47 3237-1988"\n                    }\n                ],\n                "endereco": {\n                    "id": 231,\n                    "rua": "Rua Promotor Ribeiro de Carvalho",\n                    "numero": "204",\n                    "bairro": "Vila Nova",\n                    "complemento": "",\n                    "cidade": {\n                        "id": 116137,\n                        "nome": "Blumenau",\n                        "estado": {\n                            "id": 22,\n                            "sigla": "SC",\n                            "nome": "Santa Catarina"\n                        }\n                    },\n                    "cep": "89035-340",\n                    "coordenadas": "-26.9054733,-49.0897666"\n                },\n                "stringTelefone": "(47) 3237-1988",\n                "cnpj": "34.717.377/0001-88"\n            },\n            "nome": "Alceu Guimarães",\n            "email": "amelissariver@gmail.com",\n            "telefones": [],\n            "endereco": {\n                "id": 32239,\n                "rua": "Rua Promotor Ribeiro de Carvalho",\n                "numero": "204",\n                "bairro": "Vila Nova",\n                "complemento": "",\n                "cidade": {\n                    "id": 116137,\n                    "nome": "Blumenau",\n                    "estado": {\n                        "id": 22,\n                        "sigla": "SC",\n                        "nome": "Santa Catarina"\n                    }\n                },\n                "cep": "89035-340",\n                "coordenadas": "-26.9054733,-49.0897666"\n            },\n            "stringTelefone": ""\n        },\n        "valorHora": 0,\n        "kmAtendimento": 0,\n        "funcionario": false\n    },\n    "servicos": [\n        {\n            "id": 131453,\n            "servico": {\n                "id": 9697,\n                "valor": 50,\n                "descricao": "RETIRADA"\n            },\n            "valorCliente": 50,\n            "valorTecnico": 30\n        }\n    ],\n    "endereco": {\n        "id": 206704,\n        "rua": "Rua Noel Rosa",\n        "numero": "20",\n        "bairro": "Tribess",\n        "complemento": "Casa",\n        "cidade": {\n            "id": 116137,\n            "nome": "Blumenau",\n            "estado": {\n                "id": 22,\n                "sigla": "SC",\n                "nome": "Santa Catarina"\n            }\n        },\n        "cep": "89057-420",\n        "coordenadas": "-26.8764427,-49.0531382"\n    },\n    "enderecoOrigem": 1,\n    "dataEmissao": "2023-05-25T03:00:00.000+0000",\n    "dataInstalacao": "2023-06-02T17:00:00.000+0000",\n    "distanciaDeslocamentoTecnico": 0,\n    "distanciaDeslocamentoOriginal": 0,\n    "valorPedagioTecnico": 0,\n    "valorPedagioOriginal": 0,\n    "valorDeslocamentoTecnico": 0,\n    "valorDeslocamentoOriginal": 0,\n    "observacao": "",\n    "descricaoServicos": "RETIRADA",\n    "descricaoServicosString": "RETIRADA",\n    "acessorios": [\n        {\n            "id": 54215,\n            "acessorio": {\n                "id": 129076,\n                "descricao": "SENSOR DE TEMPERATURA"\n            },\n            "quantidade": 2,\n            "quantidadeRetirada": 2,\n            "valorUnitario": 0\n        }\n    ],\n    "contatos": [\n        {\n            "id": 5175,\n            "contato": {\n                "id": 12109,\n                "cargo": "",\n                "nome": "Guilherme",\n                "telefone": "",\n                "celular": "",\n                "email": "amelissariver@gmail.com",\n                "observacao": ""\n            },\n            "observacao": "",\n            "ativo": false\n        }\n    ],\n    "equipamentos": [\n        {\n            "id": 125521,\n            "tipo": "RETIRADA",\n            "stringEquipamento": "Retirada ",\n            "equipamentoRetiradoTec": {\n                "id": 221554,\n                "codigo": "55555555",\n                "documento": "4534534",\n                "status": "INSTALADO",\n                "cancelado": false,\n                "acessorios": []\n            },\n            "tipoTec": "RETIRADA",\n            "situacao": true\n        }\n    ],\n    "arquivos": [],\n    "motivos": [],\n    "motivosTecnico": [],\n    "descricaoMotivos": "",\n    "descricaoMotivosTecnico": "",\n    "confirmacaoAgendamento": "T0C0",\n    "valorDeslocamento": 0,\n    "valorPedagio": 0,\n    "distanciaDeslocamento": 0,\n    "hodometro": 0,\n    "descricaoItens": "Bancos couro branco . Cuidao para nao sujar",\n    "etapaAPP": "SERVICO_INICIADO",\n    "visitaFrustrada": false\n}';

    final url = Uri.parse('https://siger.winksys.com.br:8443/v2/ordem_servico/salvar_equipamentos_tecnico');

    final res = await http.post(url, headers: headers, body: data);
    final status = res.statusCode;
    if (status != 200) throw Exception('http.post error: statusCode= $status');

    print(res.body);
  }
}
